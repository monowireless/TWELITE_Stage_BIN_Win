# TWELITE STAGE APP - 改定履歴
TWELITE STAGE 配布パッケージに含まれる TWELITE STAGE APP の改訂履歴です。



# 1.0.7

このバイナリ(アプリ内の表記は`1.0.107`)はコード署名していません。

* ターミナルとインタラクティブモード上で設定したボーレートを適用できるようにした。
  * 設定は、`共通設定` > `B: ボーレート`



# 1.0.6 欠番

Raspberry PI 向け



# 1.0.4,1.0.5 暫定版

このバイナリはコード署名していません。



## [65f890b] v1.0.5

### TWELITE-R,MONOSTICK以外でFTDI社のFT232,FT230を利用したデバイス(FTDI_GEN)に対応（暫定対応）

- FTDI_GENで高速書き込みに対応
- シリアルポート選択画面で c キーを入力することで、反転選択中のポートのCOM番号を調べる機能を追加

### 問題など

- デバイス一覧が正しくない場合があります（原因・出現条件は不明です）。

  

## [00e2ee0] v1.0.4

### TWELITE-R,MONOSTICK以外でFTDI社のFT232,FT230を利用したデバイス(FTDI_GEN)に対応（暫定対応）

### 使用方法

- プログラムモードへの遷移はマニュアルで実施してください。
- TWELITE 無線モジュールをプログラムモードに設定するには、PGMをLO(GND)にした状態でRSTをLO->HIにし、PGM=HIに戻します。(https://sdk.twelite.info/twelite-sdkno/fumuua/fumuua)
- ファームウェアの書き換えメニューを選択する前にプログラムモードにします。
- ファームウェアの書き換えはTWELITE-R,MONOSTICKは1Mbpsに変更していますが、上記デバイスでは38400bps固定としています。

### 問題など

- デバイス一覧が正しくない場合があります（原因・出現条件は不明です）。



# 1.0.3 MWSTAGE2020_12収録版

- TWELITE CUE対応（パーサー・CUEビューア）

- 書換メニューで、書き込み時にベリファイ（比較）を行うようにした。

- Apple Silicon暫定対応（`TWELITE_Stage.command` はユニバーサルアプリ、シリアル処理用の外部コマンド`sersrv_ftdi.command`、Toolsは Rosetta2 で動作可能な intel バイナリを再ビルド、シリアル通信は外部コマンド経由のため遅くなります)

- ディレクトリ構成で `MWSTAGE/MWSDK/Tools` を `MWSTAGE/Tools`に移動した。(MWSDKをMWSDK_COMMONレポジトリをそのまま利用できるようにするため)

- TWELITE_Stage.ini (起動ファイル名から拡張子を取り除き .ini を付加) を、起動時に読み込みMWSDKディレクトリを選択できるようにした。(古い版のライブラリ一式を簡単に切り替えられるようにした)

- 画面描画用のSDL2ライブラリを 2.0.12 に変更した (Windows, MacOS, RaspberryPi)。

- Windows では static ビルドとして DLL ファイル不要とした。

- make -j による並列ビルド数を(物理CPU数 - 1)とした。

- 書換メニューのいくつかの場所で、シリアルポートの再オープンを明示的に行うようにした。デバイスの抜き差しを行ったときなどにUSB接続が切断した場合などに、復帰しやすいようにした。

- Alt(Cmd)+Shift+m, t で mwx, twesettings を開くとき `TWENET/usever.mk` 記載のディレクトリを

  　開くようにした。

- [Raspberry Pi] 初回起動時に /dev/serial0 での書込メニュー遷移が失敗する問題を修正。

## 既知の問題

- 起動時にAlt(Cmd)押し下げ時のヘルプメッセージが出現しない場合がある。Alt(Cmd)+0を入力することで表示されます。
- 書換メニューでファイル名が長すぎる場合に、行の行事が乱れる場合がある。
- Apple Siliconでの動作については十分な検証を行っていません。



# 0.9.11 MWSTAGE2020_10, Raspberry Pi 版 (暫定版)

(※包括的な検証を実施しないバージョンです)

- Raspberry Pi での動作
- その他、機能調整



# 0.9.9 - 2020/10/12

- 最上位メニューにも[ｳｪﾌﾞ]ボタン(解説ページを開く)を追加
- Linux用でフォルダ＆URLオープンの機能を追加 (xdg-open コマンドを利用)
  - ソースコードを shell_open_???() 関数を追加して整理
- モジュールが頻繁にシリアルデータを出力する状態で「アプリ書換」メニューでエラーになる問題を修正



# 0.9.8 - 2020/10/09

### 主要な機能追加・修正

- ビューア＞コマンダーの追加 
  - 標準アプリ 0x80 コマンド
  - NOTICE PALのLED制御 (App_Wingsにコマンドを送付)
- ビューア＞PALビューアのNOTICE PAL対応。
- Actエクストラのメニューを追加
  - Act_samplesより高度なもの
  - 外部のオープンソースライブラリ（センサー手続きなど）を利用したもの
- マウスによる操作を拡大 (リスト、ボタン、タブ)
  - マウス移動でフォーカス、左クリックで確定、右クリックは[ESC]キー入力
- 画面表示負荷の低減
  - アプリケーションがバックグラウンドの時はスクリーンセーバーを無効にした
  - アプリケーションがバックグラウンドの時は、描画回数を減らして CPU 負荷を減らした
- ビルドプロジェクト(Act, TWE_Apps, Actエクストラ)の一覧の機能強化
  - 項目選択時に下部に概要を表示 (000desc.txtを読み込む。TWE_Descクラスにより処理)
  - プロジェクトフォルダを開く（またはVSCodeで開く)機能
  - 関連ウェブサイトを開く機能
  - ALt+Shift+m mwxライブラリ、Alt+Shift+t twesettingsライブラリを開く機能
  - ビルドメニュー中で選択中のフォルダやビルドエラーファイルを開けるようにした。
- ログ（シリアルポート入出力）機能の追加
  - (Alt/Cmd+L)でログの開始・終了
  - ログファイルを {TWELITE_Stage 実行形式のあるディレクトリ}/log に格納
  - ファイル名は twestage_{日付-時刻}.log
  - Shift+Alt/Cmd+L でログファイルディレクトリを開く
- その他、変更・修正など
  - シリアル(FTDI)デバイス名、IDの表示方法を変更
  - App_UARTでインタラクティブモードに遷移しなかった問題を修正
  - ディレクトリドロップ時の挙動を変更した (これまではバイナリ書き込みになる場合があったが、メニュー遷移とした)
  - ターミナル長押し時[C]でリセットに加え、画面クリアするようにした。



# 0.9.2 - 2020/08/05

### 主要な機能追加

* フォルダを開く際に code (マイクロソフト社のVisual Studio Code) コマンドを使えるようにした

  * [設定＞アプリ書換＞codeでフォルダを開く] にて設定が必要です。
  * macOS では事前に Cmd+Shift+P で [Shell Command: Install ‘code’ command in PATH] を実行しておく必要があります。

* Alt/Cmd+Ctrl+Shift+M で mwx ライブラリソースフォルダを、+Tで twesettings フォルダを code で開くようにした。

  

### その他の修正

* Alt/Cmd+0 でヘルプ画面が崩れる問題を修正した
* コンパイル対象ソースファイル抽出のためのメッセージ解釈アルゴリズムを単純化した
* フォーカスがない場合はヘルプ画面や半透明ボタン([ A ] [ B ] [ C ])へのイベント伝達を行わないようにした
* TWELITE_Stage: 10ドットフォントは常用文字入りの文字セットをロードするようにした



# 0.9.1 - 2020/07/31

### 主要な機能追加

* ログファイルの出力機能を追加した (Alt/Cmd+L で開始＆終了)
  * 終了時にはログファイルを開く
  * ログファイルの格納ディレクトリを開く (Shift+Alt/Cmd+L)
  * ログファイルは{実行形式が格納されるディレクトリ}/log
* ターミナルとインタラクティブモードの下部メニューに機能追加した
  * 直前の書き換えメニューへ遷移する
  * ソースコードのディレクトリを表示する
* ビルド時の下部メニューに機能を追加した
  * エラー・ワーニングメッセージを表示する (.../build/builderr.log)
  * ソースディレクトリを表示する



### その他の修正

* コンソール画面の制御を変更した（コンソール画面上のスクロールバッファを利用できるようにするため）
  * 内部ターミナルの制御を行わず、そのまま出力する
  * macOSでコンパイル時の表示が行われない場合があった問題を修正
  * macOSでcursesに依存していたコードをtermiosに書き換え
* アプリケーションがバックグラウンドになったときは画面の書き換え回数を減らすようにした（CPU負荷の低減）

* TWELITE_Stage の実行形式は MWSTAGE/TWELITE_Stage だが、MWSTAGE/MWSDK/mwstage といった、MWSDKより一つだけ深い階層に格納できるようにした
* スクリーンセーバが無効であったが、アプリケーションがバックグラウンド時に、スクリーンセーバの制御を行うようにした
* フォントソース生成スクリプトを追加し BDF ファイルから、必要な字数を抽出して登録できるようにした（小規模のマイコンボードなどでの消費ROMを削減する目的と、決め打ちの文字セットでは必要な文字が含まれない問題を解決するための対応）
* 問題の修正：ドラッグアンドドロップしたディレクトリに対して、再書き込みメニュー選択時にビルドにならない
* 問題の修正：書き込み時にモジュールリセットなどでハングアップする場合があった
* 問題の修正：ディレクトリ選択時にハングアップする場合があった





# 0.8.9 - MWSTAGE2020_05

2020/05月リリースに添付されていたバイナリです。